# TC007_拍卖搜索测试用例

## 测试用例概述

### 测试用例ID
TC007

### 测试用例名称
拍卖搜索

### 测试目的
验证拍卖系统是否能够正确处理拍卖物品的搜索请求，包括正常情况下的物品搜索和响应。

### 测试类型
功能测试

## 前置条件

### 测试环境要求
1. Java服务端正常运行在端口10001
2. MySQL数据库服务正常运行
3. 测试账号和角色数据已准备

### 测试数据准备
1. 创建测试账号：test_user_auction_007
2. 创建测试角色：TestPlayerAuction007
3. 确保测试账号和角色数据在数据库中存在

### 依赖服务状态
1. Java服务端：运行中
2. MySQL数据库：运行中
3. 网络连接：正常

## 测试步骤

### 步骤1: 建立TCP连接
- **操作**：创建Socket连接到localhost:10001
- **预期输出**：TCP连接建立成功

### 步骤2: 构造登录请求
- **操作**：创建REQ_LOGIN对象，设置参数
  - openid: test_user_auction_007
  - type: 1
  - token: test_token
  - platID: 1
  - clientIP: 127.0.0.1
  - version: 1.0.0
- **预期输出**：REQ_LOGIN对象创建成功

### 步骤3: 编码登录请求
- **操作**：使用MessageCodec.encode()方法编码登录请求
- **预期输出**：编码成功，返回编码后的数据

### 步骤4: 发送登录请求
- **操作**：通过OutputStream发送编码后的登录请求
- **预期输出**：登录请求发送成功

### 步骤5: 接收登录响应
- **操作**：通过InputStream接收登录响应
- **预期输出**：接收响应成功，数据长度大于0

### 步骤6: 解码登录响应
- **操作**：使用MessageCodec.decode()方法解码登录响应
- **预期输出**：解码成功，返回RES_LOGIN对象

### 步骤7: 验证登录成功
- **操作**：验证登录响应中的error字段为null，authkey字段不为null
- **预期输出**：登录验证通过

### 步骤8: 构造拍卖搜索请求
- **操作**：创建REQ_AUCTION_SEARCH对象，设置参数
  - charguid: 测试角色ID
  - keyword: 搜索关键词
  - category: 分类
  - minPrice: 最低价格
  - maxPrice: 最高价格
  - page: 页码
  - pageSize: 每页大小
  - transid: 交易ID
- **预期输出**：REQ_AUCTION_SEARCH对象创建成功

### 步骤9: 编码拍卖搜索请求
- **操作**：使用MessageCodec.encode()方法编码拍卖搜索请求
- **预期输出**：编码成功，返回编码后的数据

### 步骤10: 发送拍卖搜索请求
- **操作**：通过OutputStream发送编码后的拍卖搜索请求
- **预期输出**：拍卖搜索请求发送成功

### 步骤11: 接收拍卖搜索响应
- **操作**：通过InputStream接收拍卖搜索响应
- **预期输出**：接收响应成功，数据长度大于0

### 步骤12: 解码拍卖搜索响应
- **操作**：使用MessageCodec.decode()方法解码拍卖搜索响应
- **预期输出**：解码成功，返回RES_AUCTION_SEARCH对象

### 步骤13: 验证拍卖搜索成功
- **操作**：验证拍卖搜索响应中的error字段为0，searchResult字段不为null
- **预期输出**：拍卖搜索验证通过

### 步骤14: 数据库验证
- **操作**：查询数据库，验证测试角色是否存在
- **预期输出**：测试角色存在于数据库中

## 预期结果

### 成功情况的预期结果
1. TCP连接建立成功
2. 登录请求发送成功
3. 登录响应接收成功
4. 登录验证通过
5. 拍卖搜索请求发送成功
6. 拍卖搜索响应接收成功
7. 拍卖搜索验证通过
8. 测试数据清理完成

### 失败情况的预期结果
1. TCP连接建立失败：检查服务端是否正常运行
2. 登录失败：检查测试账号和密码是否正确
3. 拍卖搜索失败：检查拍卖系统是否正常工作

### 边界情况的预期结果
1. 角色不存在：返回错误码和错误信息
2. 参数不完整：返回错误码和错误信息
3. 搜索条件无效：返回错误码和错误信息

## 实际结果

### 测试执行后的实际结果
- **测试状态**：⏳ 待测试
- **测试时间**：-  
- **测试执行人员**：系统自动测试

### 与预期结果的对比
- **预期结果**：拍卖搜索成功，返回正确的搜索结果
- **实际结果**：-  
- **对比结果**：-  

### 测试状态
- **状态**：⏳ 待测试
- **备注**：无

## 问题记录

### 发现的问题
- 无

### 问题严重程度
- 无

### 修复建议
- 无

## 测试数据

### 测试账号
- **账号ID**：test_user_auction_007
- **密码**：123456
- **状态**：正常

### 测试角色
- **角色ID**：7
- **角色名称**：TestPlayerAuction007
- **职业**：1
- **等级**：10

## 测试日志

### 测试执行日志
- 无

### 错误日志
- 无

## 测试结论

### 测试总结
- 无

### 测试建议
- 无

### 风险评估
- **风险等级**：低
- **风险描述**：拍卖系统在处理大量搜索请求时可能存在性能问题
- **缓解措施**：优化搜索算法，使用索引加速查询，考虑使用搜索引擎