# æ‰¹æ¬¡09è¿ç§»è®¡åˆ’

## ä¸€ã€è¿ç§»æ¦‚è¿°

æ‰¹æ¬¡09å°†è¿ç§»é‚®ä»¶ï¼ˆMAILï¼‰ç›¸å…³æ¶ˆæ¯ï¼ŒåŒ…æ‹¬é‚®ä»¶åˆ—è¡¨ã€è·å–é‚®ä»¶ã€è¯»å–é‚®ä»¶ã€åˆ é™¤é‚®ä»¶ã€ä¸€é”®é¢†å–æ‰€æœ‰é‚®ä»¶ç‰©å“ã€åˆ é™¤æ‰€æœ‰é‚®ä»¶ã€è´¦å·é‚®ä»¶åˆ†é…åˆ°è§’è‰²ç­‰åŠŸèƒ½ã€‚

## äºŒã€è¿ç§»èŒƒå›´

### 2.1 é‚®ä»¶åˆ—è¡¨ (ModuleID: 15001)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| é‚®ä»¶åˆ—è¡¨è¯·æ±‚ | REQ_MAIL_LIST | 0 | å¾…è¿ç§» |
| é‚®ä»¶åˆ—è¡¨å“åº” | RES_MAIL_LIST | 1 | å¾…è¿ç§» |

### 2.2 è·å–é‚®ä»¶ (ModuleID: 15002)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| è·å–é‚®ä»¶è¯·æ±‚ | REQ_MAIL_GET | 0 | å¾…è¿ç§» |
| è·å–é‚®ä»¶å“åº” | RES_MAIL_GET | 1 | å¾…è¿ç§» |

### 2.3 è¯»å–é‚®ä»¶ (ModuleID: 15003)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| è¯»å–é‚®ä»¶è¯·æ±‚ | REQ_MAIL_READ | 0 | å¾…è¿ç§» |
| è¯»å–é‚®ä»¶å“åº” | RES_MAIL_READ | 1 | å¾…è¿ç§» |

### 2.4 åˆ é™¤é‚®ä»¶ (ModuleID: 15004)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| åˆ é™¤é‚®ä»¶è¯·æ±‚ | REQ_MAIL_DELETE | 0 | å¾…è¿ç§» |
| åˆ é™¤é‚®ä»¶å“åº” | RES_MAIL_DELETE | 1 | å¾…è¿ç§» |

### 2.5 ä¸€é”®é¢†å–æ‰€æœ‰é‚®ä»¶ç‰©å“ (ModuleID: 15005)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| ä¸€é”®é¢†å–æ‰€æœ‰é‚®ä»¶ç‰©å“è¯·æ±‚ | REQ_MAIL_ITEM_ALL_GET | 0 | å¾…è¿ç§» |
| ä¸€é”®é¢†å–æ‰€æœ‰é‚®ä»¶ç‰©å“å“åº” | RES_MAIL_ITEM_ALL_GET | 1 | å¾…è¿ç§» |

### 2.6 åˆ é™¤æ‰€æœ‰é‚®ä»¶ (ModuleID: 15006)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| åˆ é™¤æ‰€æœ‰é‚®ä»¶è¯·æ±‚ | REQ_MAIL_ALL_DELETE | 0 | å¾…è¿ç§» |
| åˆ é™¤æ‰€æœ‰é‚®ä»¶å“åº” | RES_MAIL_ALL_DELETE | 1 | å¾…è¿ç§» |

### 2.7 è´¦å·é‚®ä»¶åˆ†é…åˆ°è§’è‰² (ModuleID: 15007)

| æ¶ˆæ¯ç±»å‹ | Javaç±» | CMD | çŠ¶æ€ |
| :--- | :--- | :--- | :--- |
| è´¦å·é‚®ä»¶åˆ†é…åˆ°è§’è‰²è¯·æ±‚ | REQ_MAIL_DISTRIBUTE_ACCOUNT_TO_CHRACTER | 0 | å¾…è¿ç§» |
| è´¦å·é‚®ä»¶åˆ†é…åˆ°è§’è‰²å“åº” | RES_MAIL_DISTRIBUTE_ACCOUNT_TO_CHRACTER | 1 | å¾…è¿ç§» |

## ä¸‰ã€æ¶ˆæ¯åˆ†æ

### 3.1 REQ_MAIL_LIST

**ModuleID**: 15001
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `page` (int32, order=1): é¡µç 
- `type` (int32, order=2): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailListRequest {
  int32 page = 1;
  int32 type = 2;
}
```

### 3.2 RES_MAIL_LIST

**ModuleID**: 15001
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 
- `count` (int32, order=2): æ•°é‡
- `postallist` (List<PT_POST_ALL_LIST>, order=3): é‚®ä»¶åˆ—è¡¨
- `type` (int32, order=4): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailListResponse {
  int32 error = 1;
  int32 count = 2;
  repeated PostAllList postallist = 3;
  int32 type = 4;
}
```

### 3.3 REQ_MAIL_GET

**ModuleID**: 15002
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `type` (int32, order=1): ç±»å‹
- `guid` (uint64, order=2): GUID
- `selecteditems` (List<PT_SELECTED_ITEM>, order=3): é€‰ä¸­çš„ç‰©å“
- `selectedpackages` (List<PT_POST_PACKAGE>, order=4): é€‰ä¸­çš„åŒ…è£¹

**Protoå®šä¹‰**:
```protobuf
message MailGetRequest {
  int32 type = 1;
  uint64 guid = 2;
  repeated SelectedItem selecteditems = 3;
  repeated PostPackage selectedpackages = 4;
}
```

### 3.4 RES_MAIL_GET

**ModuleID**: 15002
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 
- `guid` (uint64, order=2): GUID
- `limit` (bool, order=3): é™åˆ¶
- `type` (int32, order=4): ç±»å‹
- `remaineditems` (List<PT_SELECTED_ITEM>, order=5): å‰©ä½™ç‰©å“
- `remainedpackages` (List<PT_POST_PACKAGE>, order=6): å‰©ä½™åŒ…è£¹
- `rewards` (PT_CONTENTS_REWARD_INFO, order=7): å¥–åŠ±

**Protoå®šä¹‰**:
```protobuf
message MailGetResponse {
  int32 error = 1;
  uint64 guid = 2;
  bool limit = 3;
  int32 type = 4;
  repeated SelectedItem remaineditems = 5;
  repeated PostPackage remainedpackages = 6;
  ContentsRewardInfo rewards = 7;
}
```

### 3.5 REQ_MAIL_READ

**ModuleID**: 15003
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `guid` (uint64, order=1): GUID
- `type` (int32, order=2): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailReadRequest {
  uint64 guid = 1;
  int32 type = 2;
}
```

### 3.6 RES_MAIL_READ

**ModuleID**: 15003
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 
- `guid` (uint64, order=2): GUID
- `type` (int32, order=3): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailReadResponse {
  int32 error = 1;
  uint64 guid = 2;
  int32 type = 3;
}
```

### 3.7 REQ_MAIL_DELETE

**ModuleID**: 15004
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `guid` (uint64, order=1): GUID
- `type` (int32, order=2): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailDeleteRequest {
  uint64 guid = 1;
  int32 type = 2;
}
```

### 3.8 RES_MAIL_DELETE

**ModuleID**: 15004
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 
- `guid` (uint64, order=2): GUID
- `type` (int32, order=3): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailDeleteResponse {
  int32 error = 1;
  uint64 guid = 2;
  int32 type = 3;
}
```

### 3.9 REQ_MAIL_ITEM_ALL_GET

**ModuleID**: 15005
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `type` (int32, order=1): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailItemAllGetRequest {
  int32 type = 1;
}
```

### 3.10 RES_MAIL_ITEM_ALL_GET

**ModuleID**: 15005
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 
- `page` (int32, order=2): é¡µç 
- `maxpage` (int32, order=3): æœ€å¤§é¡µç 
- `limit` (bool, order=4): é™åˆ¶
- `type` (int32, order=5): ç±»å‹
- `bind` (bool, order=6): ç»‘å®š
- `rewards` (PT_CONTENTS_REWARD_INFO, order=7): å¥–åŠ±

**Protoå®šä¹‰**:
```protobuf
message MailItemAllGetResponse {
  int32 error = 1;
  int32 page = 2;
  int32 maxpage = 3;
  bool limit = 4;
  int32 type = 5;
  bool bind = 6;
  ContentsRewardInfo rewards = 7;
}
```

### 3.11 REQ_MAIL_ALL_DELETE

**ModuleID**: 15006
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `type` (int32, order=1): ç±»å‹

**Protoå®šä¹‰**:
```protobuf
message MailAllDeleteRequest {
  int32 type = 1;
}
```

### 3.12 RES_MAIL_ALL_DELETE

**ModuleID**: 15006
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 
- `type` (int32, order=2): ç±»å‹
- `removecount` (int32, order=3): åˆ é™¤æ•°é‡

**Protoå®šä¹‰**:
```protobuf
message MailAllDeleteResponse {
  int32 error = 1;
  int32 type = 2;
  int32 removecount = 3;
}
```

### 3.13 REQ_MAIL_DISTRIBUTE_ACCOUNT_TO_CHRACTER

**ModuleID**: 15007
**CMD**: 0
**å­—æ®µå®šä¹‰**:
- `charguid` (uint64, order=1): è§’è‰²GUID
- `distributedmails` (List<PT_MAIL_DISTRIBUTION_ITEMS>, order=2): åˆ†é…çš„é‚®ä»¶

**Protoå®šä¹‰**:
```protobuf
message MailDistributeAccountToCharacterRequest {
  uint64 charguid = 1;
  repeated MailDistributionItems distributedmails = 2;
}
```

### 3.14 RES_MAIL_DISTRIBUTE_ACCOUNT_TO_CHRACTER

**ModuleID**: 15007
**CMD**: 1
**å­—æ®µå®šä¹‰**:
- `error` (int32, order=1): é”™è¯¯ç 

**Protoå®šä¹‰**:
```protobuf
message MailDistributeAccountToCharacterResponse {
  int32 error = 1;
}
```

## å››ã€æ•°æ®ç»“æ„å®šä¹‰

æ‰¹æ¬¡09çš„æ¶ˆæ¯éœ€è¦ä»¥ä¸‹æ•°æ®ç»“æ„ï¼š

### 4.1 PT_POST_ALL_LIST

é‚®ä»¶åˆ—è¡¨é¡¹ï¼ŒåŒ…å«30ä¸ªå­—æ®µï¼Œæ¶µç›–ï¼š
- å„ç§ç‰©å“åˆ—è¡¨ï¼ˆè£…å¤‡ã€ç§°å·ã€æ——å¸œã€ææ–™ã€æ¶ˆè€—å“ã€å¾½ç« ã€å¡ç‰‡ã€ç¥å™¨ã€ç”Ÿç‰©ã€å¤´åƒç­‰ï¼‰
- é‚®ä»¶åŸºæœ¬ä¿¡æ¯ï¼ˆç´¢å¼•ã€æ•°é‡ã€GUIDã€æ ‡é¢˜ã€å†…å®¹ã€è¿‡æœŸæ—¶é—´ï¼‰
- é‚®ä»¶çŠ¶æ€ï¼ˆå·²è¯»ã€å·²é¢†å–ï¼‰
- é‚®ä»¶åŒ…è£¹å’Œé“¾æ¥
- é‡è¦æ€§ç­‰çº§

### 4.2 PT_SELECTED_ITEM

é€‰ä¸­çš„ç‰©å“

### 4.3 PT_POST_PACKAGE

é‚®ä»¶åŒ…è£¹

### 4.4 PT_CONTENTS_REWARD_INFO

å†…å®¹å¥–åŠ±ä¿¡æ¯

### 4.5 PT_MAIL_DISTRIBUTION_ITEMS

é‚®ä»¶åˆ†é…ç‰©å“

è¿™äº›æ•°æ®ç»“æ„éœ€è¦åœ¨mail.protoä¸­å®šä¹‰æˆ–ä»common.protoä¸­å¼•ç”¨ã€‚

## äº”ã€è¿ç§»æ­¥éª¤

### æ­¥éª¤1: Protoæ–‡ä»¶æ›´æ–°

1. åˆ›å»º`mail.proto`æ–‡ä»¶ï¼Œæ·»åŠ é‚®ä»¶ç›¸å…³æ¶ˆæ¯å®šä¹‰
2. å®šä¹‰æˆ–å¼•ç”¨æ‰€éœ€çš„æ•°æ®ç»“æ„

### æ­¥éª¤2: ä»£ç ç”Ÿæˆ

1. ä½¿ç”¨bufå·¥å…·ç”ŸæˆGoä»£ç 
2. ä½¿ç”¨bufå·¥å…·ç”ŸæˆJavaä»£ç 

### æ­¥éª¤3: ç¼–è§£ç å™¨æ‰©å±•

1. åœ¨StandardProtobufDecoderä¸­æ·»åŠ é€‚é…æ–¹æ³•ï¼š
   - `adaptMailListRequest(byte[] body)`
   - `adaptMailGetRequest(byte[] body)`
   - `adaptMailReadRequest(byte[] body)`
   - `adaptMailDeleteRequest(byte[] body)`
   - `adaptMailItemAllGetRequest(byte[] body)`
   - `adaptMailAllDeleteRequest(byte[] body)`
   - `adaptMailDistributeAccountToCharacterRequest(byte[] body)`

2. åœ¨StandardProtobufEncoderä¸­æ·»åŠ é€‚é…æ–¹æ³•ï¼š
   - `adaptMailListResponse(Message msg)`
   - `adaptMailGetResponse(Message msg)`
   - `adaptMailReadResponse(Message msg)`
   - `adaptMailDeleteResponse(Message msg)`
   - `adaptMailItemAllGetResponse(Message msg)`
   - `adaptMailAllDeleteResponse(Message msg)`
   - `adaptMailDistributeAccountToCharacterResponse(Message msg)`

### æ­¥éª¤4: æµ‹è¯•ç¼–å†™

1. ç¼–å†™Goå•å…ƒæµ‹è¯•
2. ç¼–å†™ç¼–è§£ç æµ‹è¯•ç¨‹åº

### æ­¥éª¤5: æµ‹è¯•éªŒè¯

1. è¿è¡ŒGoå•å…ƒæµ‹è¯•
2. è¿è¡Œç¼–è§£ç æµ‹è¯•
3. éªŒè¯è·¨è¯­è¨€é€šä¿¡

## å…­ã€é£é™©è¯„ä¼°

### 6.1 æŠ€æœ¯é£é™©

| é£é™©é¡¹ | é£é™©ç­‰çº§ | åº”å¯¹æªæ–½ |
| :--- | :--- | :--- |
| PT_POST_ALL_LISTå­—æ®µæ•°é‡å¤š | ä¸­ | ä¸¥æ ¼æŒ‰ç…§Javaæºç è¿›è¡Œæ˜ å°„ |
| å¤æ‚çš„åµŒå¥—ç»“æ„ | ä¸­ | å‚è€ƒä¹‹å‰çš„æ‰¹æ¬¡å¤„ç†æ–¹å¼ |
| åˆ—è¡¨ç±»å‹å¤„ç† | ä½ | å‚è€ƒä¹‹å‰çš„æ‰¹æ¬¡å¤„ç†æ–¹å¼ |

### 6.2 å…¼å®¹æ€§é£é™©

| é£é™©é¡¹ | é£é™©ç­‰çº§ | åº”å¯¹æªæ–½ |
| :--- | :--- | :--- |
| ä¸ç°æœ‰æ¶ˆæ¯å†²çª | ä½ | ä½¿ç”¨æ–°çš„ModuleID |
| å­—æ®µé¡ºåºé”™è¯¯ | ä½ | ä¸¥æ ¼æŒ‰ç…§Javaæºç çš„orderå€¼ |

## ä¸ƒã€é¢„æœŸæˆæœ

1. **Protoæ–‡ä»¶**:
   - mail.proto (é‚®ä»¶ç›¸å…³æ¶ˆæ¯)

2. **ç”Ÿæˆçš„ä»£ç **:
   - Goä»£ç : gen/dnf/v1/mail.pb.go
   - Javaä»£ç : gen/java/com/dnfm/mina/protobuf/generated/

3. **ç¼–è§£ç å™¨æ‰©å±•**:
   - StandardProtobufDecoderæ–°å¢7ä¸ªé€‚é…æ–¹æ³•
   - StandardProtobufEncoderæ–°å¢7ä¸ªé€‚é…æ–¹æ³•

4. **æµ‹è¯•æ–‡ä»¶**:
   - Goå•å…ƒæµ‹è¯•: test/batch09_test.go
   - ç¼–è§£ç æµ‹è¯•: examples/batch09_codec.go

5. **æ–‡æ¡£**:
   - è¿ç§»è®¡åˆ’: devdoc/protobuf/batch_09/01_è¿ç§»è®¡åˆ’.md
   - è¿ç§»ç»“æœ: devdoc/protobuf/batch_09/02_è¿ç§»ç»“æœ.md

## å…«ã€æ—¶é—´ä¼°ç®—

| æ­¥éª¤ | é¢„è®¡æ—¶é—´ |
| :--- | :--- |
| Protoæ–‡ä»¶æ›´æ–° | 30åˆ†é’Ÿ |
| ä»£ç ç”Ÿæˆ | 5åˆ†é’Ÿ |
| ç¼–è§£ç å™¨æ‰©å±• | 40åˆ†é’Ÿ |
| æµ‹è¯•ç¼–å†™ | 30åˆ†é’Ÿ |
| æµ‹è¯•éªŒè¯ | 10åˆ†é’Ÿ |
| æ–‡æ¡£ç¼–å†™ | 10åˆ†é’Ÿ |
| **æ€»è®¡** | **125åˆ†é’Ÿ** |

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**åˆ›å»ºæ—¥æœŸ**: 2026-02-09
**åˆ›å»ºäººå‘˜**: AI Assistant
**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­
