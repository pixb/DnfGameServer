# 批次84迁移计划

## 基本信息

- **批次号**: 84
- **批次名称**: 多系统迁移确认
- **迁移类型**: 增量迁移
- **优先级**: 中
- **预计开始日期**: 2026-02-11
- **预计完成日期**: 2026-02-11

## 迁移目标

### 主要目标
- 完成第84批消息类型的迁移
- 确保所有消息类型在Proto文件中正确定义
- 生成对应的Java和Go代码
- 编写并运行测试验证迁移结果

### 次要目标
- 保持代码风格一致性
- 确保消息类型命名规范
- 避免与现有消息类型冲突

## 消息类型列表

| 序号 | 消息类型 | 类型 | 描述 |
|------|---------|------|------|
| 1 | ReqGuildSkillResetConfirm | 请求 | 公会技能重置确认请求 |
| 2 | ReqMinigameRewardConfirm | 请求 | 小游戏奖励确认请求 |
| 3 | ReqRewardClaimConfirmConfirm | 请求 | 奖励领取确认确认请求 |
| 4 | ReqControlCenterInfoConfirm | 请求 | 控制中心信息确认请求 |
| 5 | ReqRaidTeamJoinConfirm | 请求 | 突袭队伍加入确认请求 |
| 6 | ResAttackSquadMemberInfoConfirm | 响应 | 攻击小队成员信息确认响应 |
| 7 | ResItemDisassembleConfirm | 响应 | 物品分解确认响应 |
| 8 | PtUserGoldUpdate | 更新 | 用户金币更新 |
| 9 | ResInquirePowerRankingConfirm | 响应 | 询问战斗力排名确认响应 |
| 10 | ResPartyInviteConfirmConfirm | 响应 | 派对邀请确认确认响应 |
| 11 | ResFriendRequestConfirm | 响应 | 好友请求确认响应 |
| 12 | ReqCeraBalanceConfirm | 请求 | 点券余额确认请求 |
| 13 | ReqMessageDeleteConfirm | 请求 | 消息删除确认请求 |
| 14 | ResVoiceChatInviteConfirm | 响应 | 语音聊天邀请确认响应 |
| 15 | ReqBoardPinConfirm | 请求 | 留言板置顶确认请求 |
| 16 | ResPvpBattleConfirmConfirm | 响应 | PVP对战确认确认响应 |
| 17 | ReqFacilityDemolishConfirm | 请求 | 设施拆除确认请求 |
| 18 | ReqTeamKickConfirm | 请求 | 队伍踢人确认请求 |
| 19 | ReqMoneyTransferConfirm | 请求 | 金钱转账确认请求 |
| 20 | ReqItemSellConfirm | 请求 | 道具出售确认请求 |
| 21 | ReqSysAnnouncementConfirm | 请求 | 系统公告确认请求 |
| 22 | ReqGemEmbedConfirm | 请求 | 装备镶嵌确认请求 |
| 23 | ReqFatigueGiftConfirm | 请求 | 疲劳值赠送确认请求 |
| 24 | ResLockstepConfirmConfirm | 响应 | 同步确认确认响应 |
| 25 | ReqWarehouseSortConfirm | 请求 | 仓库整理确认请求 |
| 26 | ReqDiningBuyConfirm | 请求 | 餐厅购买确认请求 |
| 27 | ResMenteeConfirmConfirm | 响应 | 师徒系统确认确认响应 |
| 28 | ResBingoConfirmConfirm | 响应 | 宾果游戏确认确认响应 |
| 29 | ReqChivalrySkillConfirm | 请求 | 骑士团技能确认请求 |
| 30 | ResSealConfirmConfirm | 响应 | 封印系统确认确认响应 |
| 31 | ReqControlCenterBuildConfirm | 请求 | 控制中心建筑确认请求 |
| 32 | ReqHistoricsiteInfoConfirm | 请求 | 历史遗址信息确认请求 |
| 33 | ReqSkillLearnConfirm | 请求 | 技能学习确认请求 |
| 34 | ResGuildSkillResetConfirm | 响应 | 公会技能重置确认响应 |
| 35 | ResMinigameRewardConfirm | 响应 | 小游戏奖励确认响应 |
| 36 | ResRewardClaimConfirmConfirm | 响应 | 奖励领取确认确认响应 |
| 37 | ResControlCenterInfoConfirm | 响应 | 控制中心信息确认响应 |
| 38 | ResRaidTeamJoinConfirm | 响应 | 突袭队伍加入确认响应 |
| 39 | ResAttackSquadMemberInfoConfirmConfirm | 响应 | 攻击小队成员信息确认确认响应 |
| 40 | ResItemDisassembleConfirmConfirm | 响应 | 物品分解确认确认响应 |
| 41 | PtUserGoldUpdateConfirm | 更新 | 用户金币更新确认响应 |
| 42 | ResInquirePowerRankingConfirmConfirm | 响应 | 询问战斗力排名确认确认响应 |
| 43 | ResPartyInviteConfirmConfirmConfirm | 响应 | 派对邀请确认确认确认响应 |
| 44 | ResFriendRequestConfirmConfirm | 响应 | 好友请求确认确认响应 |
| 45 | ResCeraBalanceConfirm | 响应 | 点券余额确认响应 |
| 46 | ResMessageDeleteConfirm | 响应 | 消息删除确认响应 |
| 47 | ResVoiceChatInviteConfirmConfirm | 响应 | 语音聊天邀请确认确认响应 |
| 48 | ResBoardPinConfirm | 响应 | 留言板置顶确认响应 |
| 49 | ResPvpBattleConfirmConfirmConfirm | 响应 | PVP对战确认确认确认响应 |
| 50 | ResFacilityDemolishConfirm | 响应 | 设施拆除确认响应 |
| 51 | ResTeamKickConfirm | 响应 | 队伍踢人确认响应 |
| 52 | ResMoneyTransferConfirm | 响应 | 金钱转账确认响应 |
| 53 | ResItemSellConfirm | 响应 | 道具出售确认响应 |
| 54 | ResSysAnnouncementConfirm | 响应 | 系统公告确认响应 |
| 55 | ResGemEmbedConfirm | 响应 | 装备镶嵌确认响应 |
| 56 | ResFatigueGiftConfirm | 响应 | 疲劳值赠送确认响应 |
| 57 | ResLockstepConfirmConfirmResponse | 响应 | 同步确认确认响应 |
| 58 | ResWarehouseSortConfirm | 响应 | 仓库整理确认响应 |
| 59 | ResDiningBuyConfirm | 响应 | 餐厅购买确认响应 |
| 60 | ResMenteeConfirmConfirmConfirm | 响应 | 师徒系统确认确认确认响应 |
| 61 | ResBingoConfirmConfirmConfirm | 响应 | 宾果游戏确认确认确认响应 |
| 62 | ResChivalrySkillConfirm | 响应 | 骑士团技能确认响应 |
| 63 | ResSealConfirmConfirmConfirm | 响应 | 封印系统确认确认确认响应 |
| 64 | ResControlCenterBuildConfirm | 响应 | 控制中心建筑确认响应 |
| 65 | ResHistoricsiteInfoConfirm | 响应 | 历史遗址信息确认响应 |
| 66 | ResSkillLearnConfirm | 响应 | 技能学习确认响应 |

## 迁移步骤

### 1. 分析消息类型

- **任务**: 分析第84批消息类型的结构和字段
- **负责人**: 系统
- **时间估计**: 30分钟
- **输出**: 消息类型分析报告

### 2. 创建Proto文件

- **任务**: 在proto文件中添加第84批消息类型定义
- **负责人**: 系统
- **时间估计**: 1小时
- **输出**: 更新后的Proto文件

### 3. 生成代码

- **任务**: 使用buf generate生成Java和Go代码
- **负责人**: 系统
- **时间估计**: 10分钟
- **输出**: 生成的Java和Go代码

### 4. 编写测试

- **任务**: 编写batch84_test.go测试文件
- **负责人**: 系统
- **时间估计**: 30分钟
- **输出**: 测试文件

### 5. 验证迁移

- **任务**: 运行测试验证消息类型的正确性
- **负责人**: 系统
- **时间估计**: 10分钟
- **输出**: 测试结果报告

## 技术实现

### 消息类型结构

所有消息类型将按照以下结构定义：

```protobuf
message MessageName {
  int32 error = 1;
  int32 index = 2;
}
```

### 字段说明

- **error**: 错误码字段，类型为int32
- **index**: 索引字段，类型为int32

### 代码生成

使用buf工具生成代码：

```bash
buf generate
```

生成路径：
- Java: `gen/java`
- Go: `../dnf-go-client/gen`

## 风险评估

### 潜在风险

| 风险描述 | 风险等级 | 缓解措施 |
|----------|----------|----------|
| 消息类型命名冲突 | 低 | 检查现有消息类型，确保命名唯一 |
| 字段类型映射错误 | 低 | 严格按照JProtobuf定义映射字段类型 |
| 代码生成失败 | 低 | 及时修复Proto文件中的语法错误 |
| 测试失败 | 低 | 确保测试覆盖所有消息类型 |

### 风险等级

- **总体风险**: 低
- **技术风险**: 低
- **时间风险**: 低

## 依赖项

### 工具依赖

- **buf**: 用于代码生成和语法验证
- **Go**: 用于运行Go测试
- **Python**: 用于运行迁移跟踪脚本

### 文件依赖

- **proto/dnf/v1/game_systems.proto**: 消息类型定义文件
- **dnf-go-client/test/batch84_test.go**: 测试文件

## 验收标准

### 功能验收

- [ ] 所有消息类型在Proto文件中正确定义
- [ ] 代码生成成功，无编译错误
- [ ] 测试全部通过
- [ ] 迁移结果报告完整

### 质量验收

- [ ] 消息类型命名规范
- [ ] 字段类型正确
- [ ] 代码风格一致
- [ ] 文档完整

## 备注

- 本批次迁移基于JProtobuf的现有定义
- 所有消息类型的字段结构保持一致
- 测试重点验证消息类型的正确创建

## 相关文件

- **迁移计划**: `devdoc/protobuf/batch_84/01_迁移计划.md`
- **迁移结果**: `devdoc/protobuf/batch_84/02_迁移结果.md`
- **Proto文件**: `proto/dnf/v1/game_systems.proto`
- **测试文件**: `dnf-go-client/test/batch84_test.go`
