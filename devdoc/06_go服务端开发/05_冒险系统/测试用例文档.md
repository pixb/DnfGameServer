# 冒险系统测试用例文档

## 1. 测试目标

- 验证副本系统的功能完整性和稳定性
- 验证任务系统的功能完整性和稳定性
- 验证地图探索系统的功能完整性和稳定性
- 验证奖励系统的功能完整性和准确性
- 验证系统在高并发场景下的性能表现
- 验证系统的异常处理能力

## 2. 测试环境

### 2.1 硬件环境
- **服务器**：8核CPU，16GB内存，500GB SSD
- **客户端**：4核CPU，8GB内存，独立显卡
- **网络**：千兆局域网

### 2.2 软件环境
- **服务器**：Go 1.20，MySQL 8.0，Redis 7.0，NATS 2.9
- **客户端**：Windows 10/11，游戏客户端最新版本
- **测试工具**：JMeter 5.5，Golang测试框架

## 3. 测试用例

### 3.1 副本系统测试用例

#### 3.1.1 副本列表测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC001 | 获取副本列表 | 1. 发送GET /api/dungeon/list请求<br>2. 验证响应状态码为200<br>3. 验证返回的副本列表格式正确 | 成功返回副本列表，包含副本ID、名称、等级等信息 |
| TC002 | 按等级过滤副本 | 1. 发送GET /api/dungeon/list?level=10请求<br>2. 验证响应状态码为200<br>3. 验证返回的副本等级都适合10级玩家 | 成功返回适合10级玩家的副本列表 |
| TC003 | 按难度过滤副本 | 1. 发送GET /api/dungeon/list?difficulty=2请求<br>2. 验证响应状态码为200<br>3. 验证返回的副本难度都为2 | 成功返回难度为2的副本列表 |

#### 3.1.2 副本创建测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC004 | 创建单人副本 | 1. 发送POST /api/dungeon/create请求，不指定队友<br>2. 验证响应状态码为200<br>3. 验证返回的副本实例ID格式正确 | 成功创建副本实例，返回实例ID和时间信息 |
| TC005 | 创建组队副本 | 1. 发送POST /api/dungeon/create请求，指定队友<br>2. 验证响应状态码为200<br>3. 验证返回的副本实例ID格式正确 | 成功创建组队副本实例，返回实例ID和时间信息 |
| TC006 | 创建副本等级不足 | 1. 使用低等级玩家发送POST /api/dungeon/create请求<br>2. 验证响应状态码为403<br>3. 验证返回的错误信息正确 | 失败创建副本，返回等级不足的错误信息 |
| TC007 | 创建副本物品不足 | 1. 发送POST /api/dungeon/create请求，但玩家缺少入场券<br>2. 验证响应状态码为403<br>3. 验证返回的错误信息正确 | 失败创建副本，返回物品不足的错误信息 |

#### 3.1.3 副本进入测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC008 | 进入副本 | 1. 发送POST /api/dungeon/enter请求<br>2. 验证响应状态码为200<br>3. 验证返回的状态为entered | 成功进入副本，返回进入成功的信息 |
| TC009 | 进入不存在的副本 | 1. 发送POST /api/dungeon/enter请求，使用不存在的实例ID<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败进入副本，返回副本不存在的错误信息 |
| TC010 | 进入已结束的副本 | 1. 发送POST /api/dungeon/enter请求，使用已结束的实例ID<br>2. 验证响应状态码为409<br>3. 验证返回的错误信息正确 | 失败进入副本，返回副本已结束的错误信息 |

#### 3.1.4 副本完成测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC011 | 成功完成副本 | 1. 发送POST /api/dungeon/complete请求，设置success=true<br>2. 验证响应状态码为200<br>3. 验证返回的状态为completed<br>4. 验证返回的奖励信息正确 | 成功完成副本，返回完成状态和奖励信息 |
| TC012 | 失败完成副本 | 1. 发送POST /api/dungeon/complete请求，设置success=false<br>2. 验证响应状态码为200<br>3. 验证返回的状态为failed<br>4. 验证返回的奖励信息为空或减少 | 失败完成副本，返回失败状态和少量奖励信息 |
| TC013 | 完成不存在的副本 | 1. 发送POST /api/dungeon/complete请求，使用不存在的实例ID<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败完成副本，返回副本不存在的错误信息 |

### 3.2 任务系统测试用例

#### 3.2.1 任务接受测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC014 | 获取可接受任务 | 1. 发送GET /api/quest/available请求<br>2. 验证响应状态码为200<br>3. 验证返回的任务列表格式正确 | 成功返回可接受任务列表，包含任务ID、名称、描述等信息 |
| TC015 | 接受任务 | 1. 发送POST /api/quest/accept请求<br>2. 验证响应状态码为200<br>3. 验证返回的状态为accepted | 成功接受任务，返回接受成功的信息 |
| TC016 | 接受等级不足的任务 | 1. 使用低等级玩家发送POST /api/quest/accept请求<br>2. 验证响应状态码为403<br>3. 验证返回的错误信息正确 | 失败接受任务，返回等级不足的错误信息 |
| TC017 | 接受前置任务未完成的任务 | 1. 发送POST /api/quest/accept请求，选择有前置任务的任务<br>2. 验证响应状态码为403<br>3. 验证返回的错误信息正确 | 失败接受任务，返回前置任务未完成的错误信息 |

#### 3.2.2 任务执行测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC018 | 获取当前任务 | 1. 发送GET /api/quest/active请求<br>2. 验证响应状态码为200<br>3. 验证返回的任务列表格式正确 | 成功返回当前任务列表，包含任务ID、名称、进度等信息 |
| TC019 | 更新任务进度 | 1. 发送POST /api/quest/update请求，更新任务进度<br>2. 验证响应状态码为200<br>3. 验证返回的进度信息正确 | 成功更新任务进度，返回更新后的进度信息 |
| TC020 | 无效的任务进度更新 | 1. 发送POST /api/quest/update请求，使用无效的进度数据<br>2. 验证响应状态码为400<br>3. 验证返回的错误信息正确 | 失败更新任务进度，返回参数错误的信息 |

#### 3.2.3 任务完成测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC021 | 完成任务 | 1. 发送POST /api/quest/complete请求<br>2. 验证响应状态码为200<br>3. 验证返回的状态为completed<br>4. 验证返回的奖励信息正确 | 成功完成任务，返回完成状态和奖励信息 |
| TC022 | 完成未达到条件的任务 | 1. 发送POST /api/quest/complete请求，选择未达到完成条件的任务<br>2. 验证响应状态码为403<br>3. 验证返回的错误信息正确 | 失败完成任务，返回任务未完成的错误信息 |
| TC023 | 完成不存在的任务 | 1. 发送POST /api/quest/complete请求，使用不存在的任务ID<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败完成任务，返回任务不存在的错误信息 |

### 3.3 地图探索测试用例

#### 3.3.1 地图列表测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC024 | 获取地图列表 | 1. 发送GET /api/map/list请求<br>2. 验证响应状态码为200<br>3. 验证返回的地图列表格式正确 | 成功返回地图列表，包含地图ID、名称、类型等信息 |
| TC025 | 按区域过滤地图 | 1. 发送GET /api/map/list?area_id=1请求<br>2. 验证响应状态码为200<br>3. 验证返回的地图都属于区域1 | 成功返回区域1的地图列表 |

#### 3.3.2 地图详情测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC026 | 获取地图详情 | 1. 发送GET /api/map/detail?map_id=101请求<br>2. 验证响应状态码为200<br>3. 验证返回的地图详情格式正确 | 成功返回地图详情，包含地图ID、名称、区域等信息 |
| TC027 | 获取不存在的地图详情 | 1. 发送GET /api/map/detail?map_id=9999请求<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败获取地图详情，返回地图不存在的错误信息 |

#### 3.3.3 区域探索测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC028 | 探索区域 | 1. 发送POST /api/map/explore请求，探索新区域<br>2. 验证响应状态码为200<br>3. 验证返回的状态为discovered | 成功探索区域，返回探索成功的信息 |
| TC029 | 重复探索区域 | 1. 发送POST /api/map/explore请求，重复探索已探索的区域<br>2. 验证响应状态码为409<br>3. 验证返回的错误信息正确 | 失败探索区域，返回区域已探索的错误信息 |
| TC030 | 探索不存在的区域 | 1. 发送POST /api/map/explore请求，探索不存在的区域<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败探索区域，返回区域不存在的错误信息 |

#### 3.3.4 探索进度测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC031 | 获取探索进度 | 1. 发送GET /api/map/exploration?map_id=101请求<br>2. 验证响应状态码为200<br>3. 验证返回的探索进度格式正确 | 成功返回地图探索进度，包含已探索区域数量、总区域数量、探索百分比等信息 |
| TC032 | 获取不存在的地图探索进度 | 1. 发送GET /api/map/exploration?map_id=9999请求<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败获取探索进度，返回地图不存在的错误信息 |

### 3.4 奖励系统测试用例

#### 3.4.1 副本奖励测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC033 | 获取副本奖励 | 1. 发送GET /api/dungeon/reward?instance_id=1001请求<br>2. 验证响应状态码为200<br>3. 验证返回的奖励信息格式正确 | 成功返回副本奖励，包含物品、经验等信息 |
| TC034 | 获取不存在的副本奖励 | 1. 发送GET /api/dungeon/reward?instance_id=9999请求<br>2. 验证响应状态码为404<br>3. 验证返回的错误信息正确 | 失败获取副本奖励，返回副本实例不存在的错误信息 |

## 4. 性能测试

### 4.1 并发测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC035 | 副本创建并发测试 | 1. 使用JMeter模拟100个并发用户同时创建副本<br>2. 验证所有请求都成功完成<br>3. 验证系统响应时间不超过500ms | 所有请求成功完成，平均响应时间不超过500ms |
| TC036 | 任务更新并发测试 | 1. 使用JMeter模拟200个并发用户同时更新任务进度<br>2. 验证所有请求都成功完成<br>3. 验证系统响应时间不超过300ms | 所有请求成功完成，平均响应时间不超过300ms |
| TC037 | 地图探索并发测试 | 1. 使用JMeter模拟150个并发用户同时探索区域<br>2. 验证所有请求都成功完成<br>3. 验证系统响应时间不超过400ms | 所有请求成功完成，平均响应时间不超过400ms |

### 4.2 负载测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC038 | 长时间运行测试 | 1. 系统连续运行24小时<br>2. 期间每小时执行一次功能测试<br>3. 监控系统CPU、内存、磁盘使用率 | 系统稳定运行24小时，所有功能测试通过，资源使用率正常 |
| TC039 | 大数据量测试 | 1. 预先创建大量副本实例、任务和地图探索记录<br>2. 执行各种查询操作<br>3. 验证查询响应时间 | 查询响应时间在可接受范围内，系统正常运行 |

## 5. 异常处理测试

### 5.1 副本异常测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC040 | 副本超时测试 | 1. 创建副本实例后等待超过超时时间<br>2. 尝试进入副本<br>3. 验证返回的错误信息正确 | 失败进入副本，返回副本已超时的错误信息 |
| TC041 | 副本崩溃测试 | 1. 模拟副本实例崩溃<br>2. 尝试完成副本<br>3. 验证返回的错误信息正确 | 失败完成副本，返回副本异常的错误信息 |

### 5.2 任务异常测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC042 | 任务目标无法完成测试 | 1. 创建一个任务目标无法完成的场景<br>2. 尝试完成任务<br>3. 验证返回的错误信息正确 | 失败完成任务，返回任务目标无法完成的错误信息 |
| TC043 | 任务奖励错误测试 | 1. 模拟任务奖励发放错误<br>2. 完成任务<br>3. 验证系统能够正确处理错误并补发奖励 | 系统记录错误并尝试补发奖励 |

### 5.3 地图探索异常测试
| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
| :--- | :--- | :--- | :--- |
| TC044 | 地图数据错误测试 | 1. 模拟地图数据错误<br>2. 尝试进入地图<br>3. 验证返回的错误信息正确 | 失败进入地图，返回地图数据错误的信息 |
| TC045 | 探索进度丢失测试 | 1. 模拟探索进度数据丢失<br>2. 获取探索进度<br>3. 验证系统能够恢复数据或提供补偿 | 系统尝试恢复数据或为玩家提供补偿 |

## 6. 测试结果分析

### 6.1 功能测试结果
- 记录每个测试用例的执行结果
- 分析测试失败的原因
- 提出修复建议

### 6.2 性能测试结果
- 记录系统在不同并发量下的响应时间
- 分析系统的性能瓶颈
- 提出性能优化建议

### 6.3 异常处理测试结果
- 记录系统在异常情况下的表现
- 分析异常处理的不足之处
- 提出异常处理优化建议

## 7. 测试结论

- 总结系统的功能完整性
- 总结系统的性能表现
- 总结系统的稳定性和可靠性
- 提出系统改进的建议

## 8. 测试计划

### 8.1 测试时间安排
- **功能测试**：3天
- **性能测试**：2天
- **异常处理测试**：1天
- **测试结果分析**：1天

### 8.2 测试资源分配
- **测试人员**：2名
- **测试环境**：1套服务器环境，2套客户端环境
- **测试工具**：JMeter，Golang测试框架

### 8.3 测试风险评估
- **风险**：测试环境与生产环境差异导致测试结果不准确
  **缓解措施**：尽量模拟生产环境的配置和负载

- **风险**：测试数据量不足导致性能测试结果不具代表性
  **缓解措施**：使用脚本生成大量测试数据

- **风险**：测试时间不足导致测试覆盖不全面
  **缓解措施**：优先测试核心功能，制定详细的测试计划

## 9. 测试报告

测试完成后，将生成详细的测试报告，包括：
- 测试执行情况
- 测试结果分析
- 问题发现与修复建议
- 系统性能评估
- 测试结论与建议