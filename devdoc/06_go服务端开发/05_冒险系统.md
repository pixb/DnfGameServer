# 冒险系统设计文档

## 概述

冒险系统是游戏中的重要功能模块，包含冒险联盟、冒险奖励、冒险远征、冒险讨伐等多个子系统，用于追踪和管理玩家的冒险进度，提供丰富的游戏玩法和奖励机制。

## 功能分析

### 核心功能

#### 1. 冒险联盟信息查询
- **功能**: 查询玩家的冒险联盟信息
- **请求**: `REQ_ADVENTURE_UNION_INFO` (Module 17201)
- **响应**: `RES_ADVENTURE_UNION_INFO` (Module 17201)
- **参数**: 无
- **返回内容**:
  - `error`: 错误码
  - `exp`: 冒险联盟经验
  - `level`: 冒险联盟等级
  - `day`: 天数
  - `typicalcharacterguid`: 代表角色GUID
  - `name`: 冒险联盟名称
  - `updatetime`: 更新时间
  - `lastchangenametime`: 最后改名时间
  - `expedition`: 远征信息
  - `expeditions`: 远征列表
  - `collections`: 收藏列表
  - `collectionslots`: 收藏槽位
  - `shareboardbackground`: 展示板背景
  - `shareboardframe`: 展示板边框
  - `shareboardslotlist`: 展示板槽位列表
  - `shareboardbackgroundlist`: 展示板背景列表
  - `shareboardframelist`: 展示板边框列表
  - `shareboardshowantievilscore`: 展示板显示讨伐分数
  - `autosearchcount`: 自动搜索次数
  - `receivedcollectionrewards`: 已领取的收藏奖励
  - `levelrewards`: 等级奖励
  - `shareboardtotalantievilscore`: 展示板总讨伐分数
  - `shareboardantievilscorerefresh`: 展示板讨伐分数刷新
  - `isadventureCondition`: 冒险条件

#### 2. 冒险联盟改名
- **功能**: 修改冒险联盟名称
- **请求**: `REQ_ADVENTURE_UNION_NAME_CHANGE` (Module 17202)
- **响应**: `RES_ADVENTURE_UNION_NAME_CHANGE` (Module 17202)
- **参数**:
  - `field_1`: 新名称
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 3. 冒险联盟远征开始
- **功能**: 开始冒险联盟远征
- **请求**: `REQ_ADVENTURE_UNION_EXPEDITION_START` (Module 17203)
- **响应**: `RES_ADVENTURE_UNION_EXPEDITION_START` (Module 17203)
- **参数**:
  - `field_1`: 远征ID
  - `field_2`: 远征类型
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 4. 冒险联盟远征取消
- **功能**: 取消冒险联盟远征
- **请求**: `REQ_ADVENTURE_UNION_EXPEDITION_CANCEL` (Module 17204)
- **响应**: `RES_ADVENTURE_UNION_EXPEDITION_CANCEL` (Module 17204)
- **参数**:
  - `field_1`: 远征ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 5. 冒险联盟远征奖励
- **功能**: 领取冒险联盟远征奖励
- **请求**: `REQ_ADVENTURE_UNION_EXPEDITION_REWARD` (Module 17205)
- **响应**: `RES_ADVENTURE_UNION_EXPEDITION_REWARD` (Module 17205)
- **参数**:
  - `field_1`: 远征ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 6. 冒险联盟讨伐信息
- **功能**: 查询冒险联盟讨伐信息
- **请求**: `REQ_ADVENTURE_UNION_SUBDUE_INFO` (Module 17206)
- **响应**: `RES_ADVENTURE_UNION_SUBDUE_INFO` (Module 17206)
- **参数**: 无
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 7. 冒险联盟讨伐开始
- **功能**: 开始冒险联盟讨伐
- **请求**: `REQ_ADVENTURE_UNION_SUBDUE_START` (Module 17207)
- **响应**: `RES_ADVENTURE_UNION_SUBDUE_START` (Module 17207)
- **参数**:
  - `field_1`: 讨伐ID
  - `field_2`: 讨伐类型
  - `field_3`: 角色GUID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 8. 冒险联盟讨伐奖励
- **功能**: 领取冒险联盟讨伐奖励
- **请求**: `REQ_ADVENTURE_UNION_SUBDUE_REWARD` (Module 17208)
- **响应**: `RES_ADVENTURE_UNION_SUBDUE_REWARD` (Module 17208)
- **参数**:
  - `field_1`: 讨伐ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 9. 冒险联盟展示板槽位开启
- **功能**: 开启冒险联盟展示板槽位
- **请求**: `REQ_ADVENTURE_UNION_OPEN_SHAREBOARD_SLOT` (Module 17209)
- **响应**: `RES_ADVENTURE_UNION_OPEN_SHAREBOARD_SLOT` (Module 17209)
- **参数**:
  - `field_1`: 槽位ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 10. 冒险联盟展示板设置
- **功能**: 设置冒险联盟展示板
- **请求**: `REQ_ADVENTURE_UNION_SET_SHAREBOARD` (Module 17210)
- **响应**: `RES_ADVENTURE_UNION_SET_SHAREBOARD` (Module 17210)
- **参数**:
  - `field_1`: 展示板ID
  - `field_2`: 展示板类型
  - `field_4`: 是否显示
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 11. 冒险奖励信息
- **功能**: 查询冒险奖励信息
- **请求**: `REQ_ADVENTURE_REAP_INFO` (Module 17212)
- **响应**: `RES_ADVENTURE_REAP_INFO` (Module 17212)
- **参数**: 无
- **返回内容**:
  - `rewards`: 奖励列表
  - `starttime`: 开始时间

#### 12. 冒险奖励领取
- **功能**: 领取冒险奖励
- **请求**: `REQ_ADVENTURE_REAP_REWARD` (Module 17213)
- **响应**: `RES_ADVENTURE_REAP_REWARD` (Module 17213)
- **参数**:
  - `field_1`: 奖励ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 13. 冒险联盟搜索开始
- **功能**: 开始冒险联盟搜索
- **请求**: `REQ_ADVENTURE_UNION_SEARCH_START` (Module 17214)
- **响应**: `RES_ADVENTURE_UNION_SEARCH_START` (Module 17214)
- **参数**: 无
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 14. 冒险联盟收藏奖励
- **功能**: 领取冒险联盟收藏奖励
- **请求**: `REQ_ADVENTURE_UNION_COLLECTION_REWARD` (Module 17216)
- **响应**: `RES_ADVENTURE_UNION_COLLECTION_REWARD` (Module 17216)
- **参数**:
  - `field_1`: 收藏ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

#### 15. 冒险联盟等级奖励
- **功能**: 领取冒险联盟等级奖励
- **请求**: `REQ_ADVENTURE_UNION_LEVEL_REWARD` (Module 17217)
- **响应**: `RES_ADVENTURE_UNION_LEVEL_REWARD` (Module 17217)
- **参数**:
  - `field_1`: 等级ID
- **返回内容**:
  - `error`: 错误码
  - `transId`: 事务ID

## 数据模型设计

### 冒险联盟信息表 (t_adventure_union)

```go
type AdventureUnion struct {
    ID                      uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID                  uint64    `gorm:"column:role_id;uniqueIndex;not null" json:"roleId"`
    Name                    string    `gorm:"column:name;size:64;not null" json:"name"`
    Exp                     uint64    `gorm:"column:exp;default:0" json:"exp"`
    Level                   uint32    `gorm:"column:level;default:1" json:"level"`
    Day                     uint32    `gorm:"column:day;default:1" json:"day"`
    TypicalCharacterGUID    uint64    `gorm:"column:typical_character_guid" json:"typicalCharacterGuid"`
    LastChangeNameTime      time.Time `gorm:"column:last_change_name_time" json:"lastChangeNameTime"`
    ShareboardBackground    uint32    `gorm:"column:shareboard_background;default:0" json:"shareboardBackground"`
    ShareboardFrame         uint32    `gorm:"column:shareboard_frame;default:0" json:"shareboardFrame"`
    ShareboardShowAntiEvilScore bool  `gorm:"column:shareboard_show_antievil_score;default:false" json:"shareboardShowAntiEvilScore"`
    AutoSearchCount         uint32    `gorm:"column:auto_search_count;default:0" json:"autoSearchCount"`
    ShareboardTotalAntiEvilScore uint32 `gorm:"column:shareboard_total_antievil_score;default:0" json:"shareboardTotalAntiEvilScore"`
    ShareboardAntiEvilScoreRefresh bool `gorm:"column:shareboard_antievil_score_refresh;default:false" json:"shareboardAntiEvilScoreRefresh"`
    IsAdventureCondition    bool      `gorm:"column:is_adventure_condition;default:false" json:"isAdventureCondition"`
    CreateTime              time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
    UpdateTime              time.Time `gorm:"column:update_time;autoUpdateTime" json:"updateTime"`
}

func (AdventureUnion) TableName() string {
    return "t_adventure_union"
}
```

### 冒险联盟远征表 (t_adventure_union_expedition)

```go
type AdventureUnionExpedition struct {
    ID          uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID      uint64    `gorm:"column:role_id;index;not null" json:"roleId"`
    ExpeditionID uint32   `gorm:"column:expedition_id;not null" json:"expeditionId"`
    ExpeditionType uint32 `gorm:"column:expedition_type;not null" json:"expeditionType"`
    Status      uint32    `gorm:"column:status;default:0" json:"status"`
    StartTime   time.Time `gorm:"column:start_time" json:"startTime"`
    EndTime     time.Time `gorm:"column:end_time" json:"endTime"`
    RewardClaimed bool    `gorm:"column:reward_claimed;default:false" json:"rewardClaimed"`
    CreateTime  time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
    UpdateTime  time.Time `gorm:"column:update_time;autoUpdateTime" json:"updateTime"`
}

func (AdventureUnionExpedition) TableName() string {
    return "t_adventure_union_expedition"
}
```

### 冒险联盟讨伐表 (t_adventure_union_subdue)

```go
type AdventureUnionSubdue struct {
    ID          uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID      uint64    `gorm:"column:role_id;index;not null" json:"roleId"`
    SubdueID    uint32    `gorm:"column:subdue_id;not null" json:"subdueId"`
    SubdueType  uint32    `gorm:"column:subdue_type;not null" json:"subdueType"`
    CharacterGUID uint64 `gorm:"column:character_guid" json:"characterGuid"`
    Status      uint32    `gorm:"column:status;default:0" json:"status"`
    StartTime   time.Time `gorm:"column:start_time" json:"startTime"`
    EndTime     time.Time `gorm:"column:end_time" json:"endTime"`
    RewardClaimed bool    `gorm:"column:reward_claimed;default:false" json:"rewardClaimed"`
    CreateTime  time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
    UpdateTime  time.Time `gorm:"column:update_time;autoUpdateTime" json:"updateTime"`
}

func (AdventureUnionSubdue) TableName() string {
    return "t_adventure_union_subdue"
}
```

### 冒险联盟收藏表 (t_adventure_union_collection)

```go
type AdventureUnionCollection struct {
    ID          uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID      uint64    `gorm:"column:role_id;index;not null" json:"roleId"`
    CollectionID uint32   `gorm:"column:collection_id;not null" json:"collectionId"`
    Progress    uint32    `gorm:"column:progress;default:0" json:"progress"`
    Completed   bool      `gorm:"column:completed;default:false" json:"completed"`
    RewardClaimed bool    `gorm:"column:reward_claimed;default:false" json:"rewardClaimed"`
    CreateTime  time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
    UpdateTime  time.Time `gorm:"column:update_time;autoUpdateTime" json:"updateTime"`
}

func (AdventureUnionCollection) TableName() string {
    return "t_adventure_union_collection"
}
```

### 冒险联盟展示板槽位表 (t_adventure_union_shareboard_slot)

```go
type AdventureUnionShareboardSlot struct {
    ID          uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID      uint64    `gorm:"column:role_id;index;not null" json:"roleId"`
    SlotID      uint32    `gorm:"column:slot_id;not null" json:"slotId"`
    SlotType    uint32    `gorm:"column:slot_type;not null" json:"slotType"`
    ItemID      uint32    `gorm:"column:item_id" json:"itemId"`
    ItemCount   uint32    `gorm:"column:item_count" json:"itemCount"`
    Show        bool      `gorm:"column:show;default:false" json:"show"`
    CreateTime  time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
    UpdateTime  time.Time `gorm:"column:update_time;autoUpdateTime" json:"updateTime"`
}

func (AdventureUnionShareboardSlot) TableName() string {
    return "t_adventure_union_shareboard_slot"
}
```

### 冒险奖励表 (t_adventure_reap)

```go
type AdventureReap struct {
    ID          uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID      uint64    `gorm:"column:role_id;index;not null" json:"roleId"`
    ReapID      uint32    `gorm:"column:reap_id;not null" json:"reapId"`
    RewardType  uint32    `gorm:"column:reward_type;not null" json:"rewardType"`
    RewardIndex uint32    `gorm:"column:reward_index;not null" json:"rewardIndex"`
    RewardCount uint32    `gorm:"column:reward_count;not null" json:"rewardCount"`
    Claimed     bool      `gorm:"column:claimed;default:false" json:"claimed"`
    ClaimTime   time.Time `gorm:"column:claim_time" json:"claimTime"`
    CreateTime  time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
}

func (AdventureReap) TableName() string {
    return "t_adventure_reap"
}
```

### 冒险联盟等级奖励表 (t_adventure_union_level_reward)

```go
type AdventureUnionLevelReward struct {
    ID          uint64    `gorm:"column:id;primaryKey;autoIncrement" json:"id"`
    RoleID      uint64    `gorm:"column:role_id;index;not null" json:"roleId"`
    Level       uint32    `gorm:"column:level;not null" json:"level"`
    RewardType  uint32    `gorm:"column:reward_type;not null" json:"rewardType"`
    RewardIndex uint32    `gorm:"column:reward_index;not null" json:"rewardIndex"`
    RewardCount uint32    `gorm:"column:reward_count;not null" json:"rewardCount"`
    Claimed     bool      `gorm:"column:claimed;default:false" json:"claimed"`
    ClaimTime   time.Time `gorm:"column:claim_time" json:"claimTime"`
    CreateTime  time.Time `gorm:"column:create_time;autoCreateTime" json:"createTime"`
}

func (AdventureUnionLevelReward) TableName() string {
    return "t_adventure_union_level_reward"
}
```

## Protobuf 消息定义

### 冒险联盟信息请求

```protobuf
message AdventureUnionInfoRequest {
}

message AdventureUnionInfoResponse {
  int32 error = 1;
  uint64 exp = 2;
  uint32 level = 3;
  uint32 day = 4;
  uint64 typicalcharacterguid = 5;
  string name = 6;
  uint64 updatetime = 7;
  uint64 lastchangenametime = 8;
  AdventureUnionExpedition expedition = 9;
  repeated AdventureUnionExpedition expeditions = 10;
  repeated AdventureUnionCollection collections = 11;
  repeated AdventureUnionCollectionSlot collectionslots = 12;
  uint32 shareboardbackground = 13;
  uint32 shareboardframe = 14;
  repeated AdventureUnionShareboardSlot shareboardslotlist = 15;
  repeated AdventureUnionShareboardBackground shareboardbackgroundlist = 16;
  repeated AdventureUnionShareboardFrame shareboardframelist = 17;
  bool shareboardshowantievilscore = 18;
  uint32 autosearchcount = 19;
  repeated uint32 receivedcollectionrewards = 20;
  repeated AdventureUnionLevelReward levelrewards = 21;
  uint32 shareboardtotalantievilscore = 22;
  bool shareboardantievilscorerefresh = 23;
  bool isadventureCondition = 24;
}

message AdventureUnionExpedition {
  uint32 expedition_id = 1;
  uint32 expedition_type = 2;
  uint32 status = 3;
  uint64 start_time = 4;
  uint64 end_time = 5;
}

message AdventureUnionCollection {
  uint32 collection_id = 1;
  uint32 progress = 2;
  bool completed = 3;
}

message AdventureUnionCollectionSlot {
  uint32 slot_id = 1;
  uint32 slot_type = 2;
}

message AdventureUnionShareboardSlot {
  uint32 slot_id = 1;
  uint32 slot_type = 2;
  uint32 item_id = 3;
  uint32 item_count = 4;
  bool show = 5;
}

message AdventureUnionShareboardBackground {
  uint32 background_id = 1;
  string name = 2;
}

message AdventureUnionShareboardFrame {
  uint32 frame_id = 1;
  string name = 2;
}

message AdventureUnionLevelReward {
  uint32 level = 1;
  uint32 reward_type = 2;
  uint32 reward_index = 3;
  uint32 reward_count = 4;
  bool claimed = 5;
}
```

### 冒险联盟改名请求

```protobuf
message AdventureUnionNameChangeRequest {
  string field_1 = 1;
}

message AdventureUnionNameChangeResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险联盟远征请求

```protobuf
message AdventureUnionExpeditionStartRequest {
  int32 field_1 = 1;
  int32 field_2 = 2;
}

message AdventureUnionExpeditionStartResponse {
  int32 error = 1;
  uint64 transId = 2;
}

message AdventureUnionExpeditionCancelRequest {
  int32 field_1 = 1;
}

message AdventureUnionExpeditionCancelResponse {
  int32 error = 1;
  uint64 transId = 2;
}

message AdventureUnionExpeditionRewardRequest {
  int32 field_1 = 1;
}

message AdventureUnionExpeditionRewardResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险联盟讨伐请求

```protobuf
message AdventureUnionSubdueInfoRequest {
}

message AdventureUnionSubdueInfoResponse {
  int32 error = 1;
  uint64 transId = 2;
}

message AdventureUnionSubdueStartRequest {
  int32 field_1 = 1;
  int32 field_2 = 2;
  uint64 field_3 = 3;
}

message AdventureUnionSubdueStartResponse {
  int32 error = 1;
  uint64 transId = 2;
}

message AdventureUnionSubdueRewardRequest {
  int32 field_1 = 1;
}

message AdventureUnionSubdueRewardResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险联盟展示板请求

```protobuf
message AdventureUnionOpenShareboardSlotRequest {
  int32 field_1 = 1;
}

message AdventureUnionOpenShareboardSlotResponse {
  int32 error = 1;
  uint64 transId = 2;
}

message AdventureUnionSetShareboardRequest {
  int32 field_1 = 1;
  int32 field_2 = 2;
  bool field_4 = 4;
}

message AdventureUnionSetShareboardResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险奖励请求

```protobuf
message AdventureReapInfoRequest {
}

message AdventureReapInfoResponse {
  repeated ReapReward rewards = 1;
  uint64 starttime = 2;
  int32 error = 3;
}

message ReapReward {
  uint32 reward_type = 1;
  uint32 reward_index = 2;
  uint32 reward_count = 3;
}

message AdventureReapRewardRequest {
  int32 field_1 = 1;
}

message AdventureReapRewardResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险联盟搜索请求

```protobuf
message AdventureUnionSearchStartRequest {
}

message AdventureUnionSearchStartResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险联盟收藏奖励请求

```protobuf
message AdventureUnionCollectionRewardRequest {
  int32 field_1 = 1;
}

message AdventureUnionCollectionRewardResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

### 冒险联盟等级奖励请求

```protobuf
message AdventureUnionLevelRewardRequest {
  int32 field_1 = 1;
}

message AdventureUnionLevelRewardResponse {
  int32 error = 1;
  uint64 transId = 2;
}
```

## API 设计

### gRPC Service

```protobuf
service GameService {
  // 冒险联盟相关
  rpc AdventureUnionInfo(AdventureUnionInfoRequest) returns (AdventureUnionInfoResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/info"
      body: "*"
    };
  }

  rpc AdventureUnionNameChange(AdventureUnionNameChangeRequest) returns (AdventureUnionNameChangeResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/name_change"
      body: "*"
    };
  }

  rpc AdventureUnionExpeditionStart(AdventureUnionExpeditionStartRequest) returns (AdventureUnionExpeditionStartResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/expedition_start"
      body: "*"
    };
  }

  rpc AdventureUnionExpeditionCancel(AdventureUnionExpeditionCancelRequest) returns (AdventureUnionExpeditionCancelResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/expedition_cancel"
      body: "*"
    };
  }

  rpc AdventureUnionExpeditionReward(AdventureUnionExpeditionRewardRequest) returns (AdventureUnionExpeditionRewardResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/expedition_reward"
      body: "*"
    };
  }

  rpc AdventureUnionSubdueInfo(AdventureUnionSubdueInfoRequest) returns (AdventureUnionSubdueInfoResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/subdue_info"
      body: "*"
    };
  }

  rpc AdventureUnionSubdueStart(AdventureUnionSubdueStartRequest) returns (AdventureUnionSubdueStartResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/subdue_start"
      body: "*"
    };
  }

  rpc AdventureUnionSubdueReward(AdventureUnionSubdueRewardRequest) returns (AdventureUnionSubdueRewardResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/subdue_reward"
      body: "*"
    };
  }

  rpc AdventureUnionOpenShareboardSlot(AdventureUnionOpenShareboardSlotRequest) returns (AdventureUnionOpenShareboardSlotResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/open_shareboard_slot"
      body: "*"
    };
  }

  rpc AdventureUnionSetShareboard(AdventureUnionSetShareboardRequest) returns (AdventureUnionSetShareboardResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/set_shareboard"
      body: "*"
    };
  }

  // 冒险奖励相关
  rpc AdventureReapInfo(AdventureReapInfoRequest) returns (AdventureReapInfoResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/reap/info"
      body: "*"
    };
  }

  rpc AdventureReapReward(AdventureReapRewardRequest) returns (AdventureReapRewardResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/reap/reward"
      body: "*"
    };
  }

  // 冒险联盟搜索
  rpc AdventureUnionSearchStart(AdventureUnionSearchStartRequest) returns (AdventureUnionSearchStartResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/search_start"
      body: "*"
    };
  }

  // 冒险联盟收藏奖励
  rpc AdventureUnionCollectionReward(AdventureUnionCollectionRewardRequest) returns (AdventureUnionCollectionRewardResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/collection_reward"
      body: "*"
    };
  }

  // 冒险联盟等级奖励
  rpc AdventureUnionLevelReward(AdventureUnionLevelRewardRequest) returns (AdventureUnionLevelRewardResponse) {
    option (google.api.http) = {
      post: "/api/v1/adventure/union/level_reward"
      body: "*"
    };
  }
}
```

## 业务逻辑

### 冒险联盟改名流程

1. **验证请求**
   - 检查玩家是否登录
   - 验证新名称是否合法
   - 检查改名冷却时间
   - 检查改名次数限制

2. **处理改名**
   - 更新冒险联盟名称
   - 更新最后改名时间
   - 记录改名历史

3. **返回响应**
   - 返回成功或错误信息

### 冒险联盟远征流程

1. **验证请求**
   - 检查玩家是否登录
   - 验证远征ID是否有效
   - 检查远征条件
   - 检查是否有进行中的远征

2. **开始远征**
   - 创建远征记录
   - 设置远征状态
   - 记录开始时间

3. **返回响应**
   - 返回成功或错误信息

### 冒险联盟讨伐流程

1. **验证请求**
   - 检查玩家是否登录
   - 验证讨伐ID是否有效
   - 检查讨伐条件
   - 验证角色GUID

2. **开始讨伐**
   - 创建讨伐记录
   - 设置讨伐状态
   - 记录开始时间

3. **返回响应**
   - 返回成功或错误信息

### 冒险奖励领取流程

1. **验证请求**
   - 检查玩家是否登录
   - 验证奖励ID是否有效
   - 检查奖励是否已领取

2. **处理奖励**
   - 更新奖励领取状态
   - 发放奖励物品到玩家背包
   - 更新冒险联盟经验

3. **返回响应**
   - 返回奖励物品信息
   - 返回冒险联盟经验

## 测试用例设计

### 测试场景

1. **冒险联盟信息查询测试**
   - 查询冒险联盟信息
   - 验证返回数据完整性
   - 检查默认值

2. **冒险联盟改名测试**
   - 修改冒险联盟名称
   - 验证名称更新
   - 检查改名冷却时间
   - 测试非法名称

3. **冒险联盟远征测试**
   - 开始远征
   - 取消远征
   - 领取远征奖励
   - 测试重复远征

4. **冒险联盟讨伐测试**
   - 开始讨伐
   - 领取讨伐奖励
   - 测试重复讨伐

5. **冒险联盟展示板测试**
   - 开启展示板槽位
   - 设置展示板
   - 测试展示板显示

6. **冒险奖励测试**
   - 查询冒险奖励信息
   - 领取冒险奖励
   - 测试重复领取

7. **冒险联盟搜索测试**
   - 开始搜索
   - 验证搜索结果

8. **冒险联盟收藏奖励测试**
   - 领取收藏奖励
   - 测试重复领取

9. **冒险联盟等级奖励测试**
   - 领取等级奖励
   - 测试重复领取

## 实现计划

### 阶段一：基础功能
1. 实现数据模型
2. 实现 Protobuf 消息定义
3. 实现基础 Handler

### 阶段二：业务逻辑
1. 实现冒险联盟 Service
2. 实现冒险奖励 Service
3. 实现远征和讨伐逻辑
4. 实现展示板逻辑

### 阶段三：集成测试
1. 编写测试用例
2. 集成到主服务器
3. 运行测试验证

## 注意事项

1. **并发安全**: 冒险奖励领取需要考虑并发问题
2. **数据一致性**: 确保奖励发放和状态更新的原子性
3. **性能优化**: 冒险联盟信息查询需要缓存优化
4. **错误处理**: 完善的错误提示和日志记录
5. **扩展性**: 设计支持冒险类型的扩展
6. **冷却时间**: 改名等功能需要考虑冷却时间
7. **权限控制**: 某些功能需要权限验证

## 参考资源

### Java 代码
- `src/main/java/com/dnfm/game/adventure/AdventureController.java`
- `src/main/java/com/dnfm/game/adventure/model/AdventureUnionInfo.java`
- `src/main/java/com/dnfm/game/adventure/model/AdventureReapInfo.java`

### Protobuf 定义
- `proto/dnf/v1/task.proto`
- `proto/dnf/v1/batch_53_basic_res/basic_res.proto`
- `proto/dnf/v1/batch_54_basic_res/basic_res.proto`
- `proto/dnf/v1/batch_59_basic_pt/basic_pt.proto`

### 相关模块
- 背包系统
- 成就系统
- 物品系统
- 角色系统
