# 制作系统 - Java代码分析

## 1. 核心控制器

| 控制器类 | 主要功能 | 关键方法 |
| :--- | :--- | :--- |
| `CraftController` | 制作系统主控制器 | `handleCraftList`, `handleCraftCreate`, `handleCraftSkill`, `handleCraftBatch`, `handleCraftPreview` |

## 2. 核心功能

### 2.1 制作配方查询

**功能描述**：查询可制作的物品配方，了解所需材料和条件

**请求处理**：`REQ_CRAFT_LIST`

**核心逻辑**：
1. 验证请求参数
2. 查询可制作配方
3. 验证技能等级
4. 返回配方列表

### 2.2 物品制作

**功能描述**：使用材料制作物品，自动消耗材料并生成成品

**请求处理**：`REQ_CRAFT_CREATE`

**核心逻辑**：
1. 验证配方存在性
2. 验证技能等级
3. 验证材料充足
4. 消耗材料
5. 生成成品
6. 提升技能经验

### 2.3 制作技能升级

**功能描述**：通过制作物品提升制作技能等级，解锁更多配方

**请求处理**：`REQ_CRAFT_SKILL`

**核心逻辑**：
1. 验证角色身份
2. 查询技能等级
3. 计算升级所需经验
4. 执行升级操作

### 2.4 批量制作

**功能描述**：一次性制作多个相同物品，提高效率

**请求处理**：`REQ_CRAFT_BATCH`

**核心逻辑**：
1. 验证配方存在性
2. 验证技能等级
3. 验证材料充足
4. 批量消耗材料
5. 批量生成成品
6. 批量提升技能经验

### 2.5 制作预览

**功能描述**：预览制作结果，包括物品属性和成功率

**请求处理**：`REQ_CRAFT_PREVIEW`

**核心逻辑**：
1. 验证配方存在性
2. 验证技能等级
3. 计算制作成功率
4. 生成预览结果