# 制作系统 - 数据库设计文档

## 1. 表结构

### 1.1 制作配方表 (`t_craft_recipe`)

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `id` | `BIGINT UNSIGNED` | `PRIMARY KEY AUTO_INCREMENT` | 配方ID |
| `itemIndex` | `INT UNSIGNED` | `NOT NULL UNIQUE INDEX` | 物品索引 |
| `itemName` | `VARCHAR(100)` | `NOT NULL` | 物品名称 |
| `skillLevel` | `INT UNSIGNED` | `NOT NULL` | 所需技能等级 |
| `successRate` | `FLOAT` | `NOT NULL` | 基础成功率 |
| `description` | `VARCHAR(500)` | `NOT NULL` | 配方描述 |
| `createTime` | `DATETIME` | `NOT NULL DEFAULT CURRENT_TIMESTAMP` | 创建时间 |
| `updateTime` | `DATETIME` | `NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间 |

### 1.2 制作材料表 (`t_craft_material`)

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `id` | `BIGINT UNSIGNED` | `PRIMARY KEY AUTO_INCREMENT` | 材料ID |
| `recipeId` | `BIGINT UNSIGNED` | `NOT NULL INDEX` | 配方ID |
| `materialIndex` | `INT UNSIGNED` | `NOT NULL` | 材料索引 |
| `materialCount` | `INT UNSIGNED` | `NOT NULL` | 材料数量 |
| `createTime` | `DATETIME` | `NOT NULL DEFAULT CURRENT_TIMESTAMP` | 创建时间 |

### 1.3 制作技能表 (`t_craft_skill`)

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `id` | `BIGINT UNSIGNED` | `PRIMARY KEY AUTO_INCREMENT` | 技能ID |
| `roleId` | `BIGINT UNSIGNED` | `NOT NULL UNIQUE INDEX` | 角色ID |
| `skillLevel` | `INT UNSIGNED` | `NOT NULL DEFAULT 1` | 技能等级 |
| `experience` | `BIGINT UNSIGNED` | `NOT NULL DEFAULT 0` | 技能经验 |
| `createTime` | `DATETIME` | `NOT NULL DEFAULT CURRENT_TIMESTAMP` | 创建时间 |
| `updateTime` | `DATETIME` | `NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | 更新时间 |

### 1.4 制作记录表 (`t_craft_record`)

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `id` | `BIGINT UNSIGNED` | `PRIMARY KEY AUTO_INCREMENT` | 记录ID |
| `roleId` | `BIGINT UNSIGNED` | `NOT NULL INDEX` | 角色ID |
| `recipeId` | `BIGINT UNSIGNED` | `NOT NULL` | 配方ID |
| `itemIndex` | `INT UNSIGNED` | `NOT NULL` | 物品索引 |
| `itemCount` | `INT UNSIGNED` | `NOT NULL` | 物品数量 |
| `success` | `BOOLEAN` | `NOT NULL` | 是否成功 |
| `skillGained` | `BIGINT UNSIGNED` | `NOT NULL` | 获得的技能经验 |
| `createTime` | `DATETIME` | `NOT NULL DEFAULT CURRENT_TIMESTAMP` | 创建时间 |

## 2. 索引设计

| 表名 | 索引名 | 索引类型 | 索引字段 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| `t_craft_recipe` | `idx_item_index` | `BTREE` | `itemIndex` | 加速物品索引查询 |
| `t_craft_material` | `idx_recipe_id` | `BTREE` | `recipeId` | 加速配方材料查询 |
| `t_craft_skill` | `idx_role_id` | `BTREE` | `roleId` | 加速角色技能查询 |
| `t_craft_record` | `idx_role_id` | `BTREE` | `roleId` | 加速角色制作记录查询 |