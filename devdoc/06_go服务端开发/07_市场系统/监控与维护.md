# 市场系统 - 监控与维护

## 1. 监控指标

| 指标名称 | 类型 | 说明 | 监控方式 |
| :--- | :--- | :--- | :--- |
| 市场物品数量 | `Gauge` | 当前市场中的物品数量 | Prometheus |
| 交易次数 | `Counter` | 市场交易的总次数 | Prometheus |
| 交易金额 | `Counter` | 市场交易的总金额 | Prometheus |
| 上架物品数量 | `Counter` | 上架物品的总数量 | Prometheus |
| 下架物品数量 | `Counter` | 下架物品的总数量 | Prometheus |
| 搜索请求次数 | `Counter` | 市场搜索的总请求次数 | Prometheus |
| 错误率 | `Counter` | 错误次数 / 总请求次数 | Prometheus |
| 响应时间 | `Histogram` | API 响应时间分布 | Prometheus |

## 2. 日志管理

| 日志级别 | 说明 | 存储位置 |
| :--- | :--- | :--- |
| `debug` | 调试信息 | `logs/debug.log` |
| `info` | 普通信息 | `logs/info.log` |
| `warn` | 警告信息 | `logs/warn.log` |
| `error` | 错误信息 | `logs/error.log` |

## 3. 常见问题

| 问题 | 原因 | 解决方案 |
| :--- | :--- | :--- |
| 物品上架失败 | 物品不存在或不属于玩家 | 验证物品所有权和存在性 |
| 物品购买失败 | 货币不足或物品已被购买 | 验证货币余额和物品状态 |
| 市场搜索缓慢 | 数据量过大或索引缺失 | 优化数据库索引和查询 |
| 过期物品未清理 | 定时任务未执行 | 检查定时任务配置 |
| 交易数据不一致 | 并发操作导致 | 确保交易操作的原子性 |