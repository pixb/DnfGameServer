# pix-jptotobuf-to-proto 技能

## 📂 基础信息

| 属性 | 值 |
| :--- | :--- |
| **名称** | pix-jptotobuf-to-proto |
| **版本** | 1.0.0 |
| **类型** | 工具技能 (Tool Skill) |
| **核心功能** | JProtobuf 到标准 Protobuf 迁移 |
| **适用环境** | Trae |

## 🎯 项目概述

pix-jptotobuf-to-proto 是一个专门用于帮助开发者将 Java 项目中的 JProtobuf 协议迁移到标准 Protobuf 协议的工具技能。它提供了结构化的 7 步迁移流程，确保迁移过程可控、可追踪，同时积累迁移经验。

### 核心特性

| 特性 | 描述 |
| :--- | :--- |
| **结构化流程** | 7 步标准化迁移流程，从分析到验证 |
| **批次管理** | 批次化文档结构，支持大规模迁移 |
| **跨语言支持** | 生成 Java 和 Go 代码，确保跨语言通信 |
| **类型映射** | 详细的 JProtobuf 到标准 Protobuf 类型映射 |
| **经验积累** | 标准化的经验总结模板，避免重复错误 |
| **风险控制** | 渐进式迁移策略和回退方案 |

## 🛠️ 工作原理

当用户请求迁移 JProtobuf 到标准 Protobuf 时，pix-jptotobuf-to-proto 会引导用户完成以下 7 个阶段：

### 阶段 1: 分析 Java 文件
- 分析 `@Protobuf` 注解的字段定义
- 确认字段类型和顺序
- 映射到标准 Protobuf 类型

### 阶段 2: 生成 Proto 文件
- 在 `proto` 目录创建对应文件
- 保持字段序号和类型一致性
- 验证 Proto 文件语法正确

### 阶段 3: 生成 Go 代码
- 执行 `buf generate` 生成 Go 代码
- 验证生成的代码编译通过
- 审查生成的代码结构

### 阶段 4: 编写 Go 测试用例
- 创建测试文件并编写测试用例
- 测试序列化/反序列化功能
- 测试边界值和异常情况

### 阶段 5: 生成 Java 代码
- 执行 `buf generate` 生成 Java 代码
- 将生成的代码集成到 Java 工程
- 验证 Java 代码编译通过

### 阶段 6: 调试 Java 服务端
- 修改 Java 代码使用新协议
- 编译并启动 Java 服务端
- 解决启动过程中的错误

### 阶段 7: 运行 Go 测试用例
- 再次运行 Go 测试用例
- 验证 Java 与 Go 通信正常
- 记录本次迁移的经验

## 📁 目录结构

### 技能目录结构

```
pix-jptotobuf-to-proto/
├── SKILL.md          ← 核心技能文件
├── README.md         ← 技能说明文档
└── references/       ← 参考资源
    └── templates/     ← 文档模板
```

### 迁移文档结构

```
devdoc/protobuf/batch_XX/
├── 01_迁移计划.md      # 迁移概览和步骤
├── 02_文件映射.md      # Java到Proto的映射
├── 03_测试规划.md      # 测试策略和用例
└── 04_经验总结.md      # 问题和解决方案
```

## 🚀 使用指南

### 激活方式

当你询问以下类型的问题时，pix-jptotobuf-to-proto 会自动激活：

- "迁移 JProtobuf 到标准 Protobuf"
- "将 Java 的 JProtobuf 转换为标准 Protobuf"
- "批量迁移 JProtobuf 协议"
- "JProtobuf 到 Proto 的映射"
- "为 JProtobuf 迁移创建批次计划"

### 预期输出

pix-jptotobuf-to-proto 会提供：
1. 完整的 7 步迁移流程指南
2. 详细的文件映射和类型转换规则
3. 批次化的迁移计划和文档模板
4. 跨语言测试策略和验证方法
5. 经验总结和问题解决方案

### 使用示例

#### 示例 1: 单文件迁移

**用户请求**："迁移 LOGIN.java 文件到标准 Protobuf"

**响应**：提供完整的迁移计划，包括分析、映射、生成代码、测试和验证步骤。

#### 示例 2: 批次迁移计划

**用户请求**："为第一批迁移创建计划"

**响应**：创建批次目录结构，生成迁移计划、文件映射、测试规划和经验总结文档模板。

## 📚 支持的概念范围

pix-jptotobuf-to-proto 支持以下概念：

| 概念 | 描述 |
| :--- | :--- |
| **JProtobuf 注解** | 分析 `@Protobuf` 注解的字段定义 |
| **标准 Protobuf** | 生成符合标准的 Proto 文件 |
| **类型映射** | JProtobuf 到标准 Protobuf 的类型映射 |
| **跨语言通信** | Java 与 Go 之间的通信验证 |
| **渐进式迁移** | 小规模、可控的迁移策略 |
| **批次化管理** | 大规模迁移的批次化文档管理 |
| **经验积累** | 迁移经验的记录和总结 |

## 🎓 设计理念

pix-jptotobuf-to-proto 的设计基于以下理念：

1. **结构化流程**：从分析到验证的完整流程，确保迁移过程可控
2. **批次化管理**：通过批次化文档，支持大规模迁移的有序进行
3. **跨语言验证**：确保 Java 与 Go 等多语言通信正常
4. **经验积累**：详细记录问题和解决方案，避免重复错误
5. **风险控制**：渐进式迁移策略和回退方案，降低迁移风险

通过遵循这些理念，pix-jptotobuf-to-proto 不仅帮助用户完成当前的迁移任务，还为未来的迁移工作积累宝贵经验。

## 🤝 贡献指南

要为 pix-jptotobuf-to-proto 技能做出贡献：

1. Fork 仓库
2. 为你的更改创建一个新分支
3. 添加新的功能或改进现有功能
4. 提交拉取请求与你的更改

## 💡 反馈

我们欢迎反馈以改进 pix-jptotobuf-to-proto 技能。请提供以下方面的建议：

- 新的功能需求
- 更好的迁移流程或指南
- 改进的文档或模板
- 错误修复或性能增强

## 📄 许可证

本技能以 MIT 许可证发布。